https://docs.confluent.io/current/ksql/docs/tutorials/basics-docker.html

CREATE TABLE users_original (registertime BIGINT, gender VARCHAR, regionid VARCHAR, userid VARCHAR) WITH
(kafka_topic='users', value_format='JSON', key = 'userid');

CREATE STREAM pageviews_original (viewtime bigint, userid varchar, pageid varchar) WITH
(kafka_topic='pageviews', value_format='JSON');

CREATE STREAM pageviews_enriched AS
SELECT users_original.userid AS userid, pageid, regionid, gender
FROM pageviews_original
LEFT JOIN users_original ON pageviews_original.userid = users_original.userid;

SELECT pageid FROM pageviews_original LIMIT 3;
SELECT * FROM pageviews_enriched;
SELECT gender, regionid, numusers FROM pageviews_regions LIMIT 5;
